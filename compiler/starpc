#!/usr/bin/env python3
import sys, os
from binGenerator import buildBin
from main import build, DebugFlags

if __name__ == "__main__":
    fileName = ""

    if len(sys.argv) < 2:
        print("Please input an input file to run.")
        exit(1)
    else:
        fileName = sys.argv[1]
    outputFile = open(".".join(fileName.split(".")[:-1]) + ".starpc", "w")
    with open(fileName, 'r') as f:
        os.chdir(os.path.dirname(os.path.abspath(sys.argv[1])))
        outputtedAssembly = build(f.read(), filePath=fileName)
        if DebugFlags.showBytecode:
            print("================== GENERATED BYTECODE ==================")
            print(outputtedAssembly)

        outputFile.write(outputtedAssembly)
        print("writed")
    outputFile.close()


    buildBin(fileName=fileName + "c")
    