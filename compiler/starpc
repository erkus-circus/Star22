#!/usr/bin/env python3
import sys
from main import build, DebugFlags, buildBin

if __name__ == "__main__":
    fileName = ""
    if len(sys.argv) < 2:
        print("Please input an input file to run.")
        exit(1)
    else:
        fileName = sys.argv[1]
    
    outputFile = open(".".join(fileName.split(".")[:-1]) + ".starpc", "w")
    with open(fileName, 'r') as f:
        outputtedAssembly = build(f.read())
        if DebugFlags.showBytecode:
            print("================== GENERATED BYTECODE ==================")
            print(outputtedAssembly)

        outputFile.write(outputtedAssembly)
        print("writed")
    outputFile.close()


    buildBin(fileName=fileName + "c")
